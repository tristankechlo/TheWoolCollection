plugins {
    id 'java'
    id 'org.spongepowered.gradle.vanilla' version '0.2.1-SNAPSHOT'
    //id 'maven-publish'
}

archivesBaseName = "${mod_id}-common-${minecraft_version}"

minecraft {
    version(minecraft_version)
    runs {
        if (project.hasProperty('common_runs_enabled') ? project.findProperty('common_runs_enabled').toBoolean() : true) {

            server('Common Server') {
                workingDirectory(this.file("run"))
            }
            client('Common Client') {
                workingDirectory(this.file("run"))
            }
        }
    }
}

sourceSets.main.resources.srcDir 'src/generated/resources'

dependencies {
    compileOnly group: 'org.spongepowered', name: 'mixin', version: '0.8.5'
}

processResources {

    def buildProps = project.properties.clone()

    filesMatching(['pack.mcmeta']) {

        expand buildProps
    }
}

task generateRessources(type: Exec) {
    outputs.upToDateWhen { false }
    workingDir = file("../generator")
    commandLine = ["python.exe", "generate.py"]
}

configure (generateRessources) {
    group = "build"
    description = "generate all wool variants"
}

// add custom ressource generation task to build task
tasks.build.dependsOn(generateRessources)
